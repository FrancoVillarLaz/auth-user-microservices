########################################
# Server
########################################
quarkus.http.host=0.0.0.0
quarkus.http.port=8080
# quarkus.http.port=${SERVER_PORT:8080}

quarkus.http.root-path=/api/auth-service

########################################
# Database
########################################
quarkus.datasource.db-kind=mysql
quarkus.datasource.username=${DB_USERNAME:db_user}
quarkus.datasource.password=${DB_PASSWORD:db_password_placeholder}
quarkus.datasource.jdbc.url=${DB_URL:jdbc:mysql://localhost:3306/auth_service_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC}
quarkus.datasource.jdbc.driver=com.mysql.cj.jdbc.Driver
quarkus.hibernate-orm.database.generation=${DB_GENERATION:update}
quarkus.datasource.jdbc.max-size=16
quarkus.datasource.jdbc.min-size=2

########################################
# Redis
########################################
quarkus.redis.hosts=redis://localhost:6379
quarkus.redis.password=${REDIS_PASSWORD:redis_password_placeholder}

########################################
# Kafka
########################################
# Mensajería

# Kafka Broker local
mp.messaging.connector.smallrye-kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:29092}

# Auth events
mp.messaging.outgoing.auth-events.connector=smallrye-kafka
mp.messaging.outgoing.auth-events.topic=auth.events
mp.messaging.outgoing.auth-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer
mp.messaging.outgoing.auth-events.key.serializer=org.apache.kafka.common.serialization.StringSerializer

# User events
mp.messaging.incoming.user-events.connector=smallrye-kafka
mp.messaging.incoming.user-events.topic=user.personal.events
mp.messaging.incoming.user-events.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.user-events.auto.offset.reset=earliest
mp.messaging.incoming.user-events.enable.auto.commit=true

########################
# JWT - RS256
########################

# Propiedades para la GENERACIÓN/FIRMA
smallrye.jwt.sign.key.location=classpath:META-INF/keys/privateKey.pem
smallrye.jwt.sign.key-format=PEM
smallrye.jwt.sign.algorithm=RS256

# Propiedades de VERIFICACIÓN
mp.jwt.verify.publickey.location=classpath:META-INF/keys/publicKey.pem
mp.jwt.verify.issuer=auth-service

# Claim mapping
smallrye.jwt.path.groups=role

# Expiración
jwt.access.token.expiration=${JWT_EXPIRATION:86400000}
jwt.refresh.token.expiration=${JWT_REFRESH_EXPIRATION:604800000}

quarkus.smallrye-jwt.subject.claim=userId
smallrye.jwt.claims.sub-path=userId
smallrye.jwt.require.named-principal=false

# Issuer
smallrye.jwt.verify.issuer=auth-service

########################################
# Logging
########################################
quarkus.log.console.level=INFO
quarkus.log.level=INFO
quarkus.log.category."io.smallrye.jwt".level=INFO

########################################
# Dev Services
########################################
quarkus.devservices.enabled=false

########################################
# CORS
########################################
quarkus.http.cors=true
quarkus.http.cors.origins=${CORS_ALLOWED_ORIGIN:*}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=location,authorization
quarkus.http.cors.access-control-allow-credentials=true